# Multi-Camera Editor - User Guide

**自動カメラ切り替え機能の使い方**

---

## 目次

1. [概要](#概要)
2. [使用前の準備](#使用前の準備)
3. [基本ワークフロー](#基本ワークフロー)
4. [詳細設定](#詳細設定)
5. [結果の確認と調整](#結果の確認と調整)
6. [トラブルシューティング](#トラブルシューティング)
7. [FAQ](#faq)

---

## 概要

Multi-Camera Editorは、Autopodと同様のワークフローで、複数カメラの映像を話者に応じて自動的に切り替えるPremiere Pro拡張機能です。

### できること

- **3カメラ映像の自動切り替え** - 話者の音声を検出して適切なカメラに自動スイッチ
- **シンプルな4ステップ** - セットアップ、設定、処理、調整の直感的なワークフロー
- **カスタマイズ可能** - カット頻度、最小カット長、トランジションなどを調整可能
- **視覚的フィードバック** - 音声レベルのグラフ表示で結果を確認

### 使用シーン

- ポッドキャスト・対談番組の編集
- インタビュー動画の編集
- パネルディスカッションの編集
- 複数話者のウェビナー収録

---

## 使用前の準備

### 必要なもの

1. **Premiere Pro v25.0以上** がインストールされていること
2. **同期済みのマルチカメラ映像** - 3つのカメラアングルを含むシーケンス
3. **音声トラック** - 各カメラクリップに話者の音声が含まれていること

### シーケンスの構成

プラグインは以下のシーケンス構成を想定しています:

```
Timeline (Sequence)
├── Video Track 1: Camera 1 (例: 話者Aのアップ)
├── Video Track 2: Camera 2 (例: 話者Bのアップ)
├── Video Track 3: Camera 3 (例: 引きの全体像)
└── Audio Tracks: 各カメラの音声
```

**重要**:
- すべてのカメラクリップは**時間的に同期**されている必要があります
- 各クリップには**音声トラック**が必要です（話者検出に使用）
- ビデオトラックの順序は任意ですが、処理前に明示的に指定します

---

## 基本ワークフロー

Multi-Camera Editorは**4つのステップ**で完結します。

### Step 1: セットアップ (Setup)

拡張パネルを開き、3つのカメラアングルを指定します。

1. **Window → Extensions → Auto Camera Switcher** でパネルを開く
2. 各カメラボタンをクリックし、タイムライン上のクリップを選択:
   - **Camera 1** ボタン → タイムラインでクリップ選択 → "Camera 1: [クリップ名]" と表示
   - **Camera 2** ボタン → タイムラインでクリップ選択 → "Camera 2: [クリップ名]" と表示
   - **Camera 3** ボタン → タイムラインでクリップ選択 → "Camera 3: [クリップ名]" と表示

**Tips**:
- カメラの役割（話者A、話者B、全体像など）をメモしておくと便利です
- 誤って選択した場合は、同じボタンを再度クリックして選び直せます

### Step 2: 設定 (Configuration)

処理の詳細設定を行います。デフォルト値でも十分機能しますが、用途に応じて調整できます。

#### 基本設定

| 設定項目 | デフォルト | 説明 |
|---------|-----------|------|
| **最小カット長** | 2.0秒 | カットの最小持続時間（これより短いカットは作成されません） |
| **サンプリングレート** | 1.0秒 | 音声解析の間隔（小さいほど精密、大きいほど高速） |
| **カット頻度** | Medium | 切り替えの頻度（High/Medium/Low） |
| **トランジション** | 0.0秒 | カット間のクロスディゾルブ時間 |

#### カット頻度の選び方

- **High**: 会話テンポが速い、複数人が頻繁に話す → カット間隔 1-2秒
- **Medium**: 通常の対談・インタビュー → カット間隔 2-3秒（推奨）
- **Low**: ゆっくりとした会話、長い発言が多い → カット間隔 3-5秒

**例: ポッドキャスト編集の場合**
```
最小カット長: 2.0秒
サンプリングレート: 1.0秒
カット頻度: Medium
トランジション: 0.0秒（カットのみ）
```

### Step 3: 処理 (Processing)

設定が完了したら、自動編集を実行します。

1. **"Create Multicam Edit"** ボタンをクリック
2. 処理が開始され、プログレスバーが表示されます:
   - **Phase 1**: 音声解析中... (30-60秒程度)
   - **Phase 2**: カット生成中... (5-10秒程度)
   - **Phase 3**: タイムライン編集中... (10-20秒程度)
3. 完了すると、新しいシーケンス **"[元のシーケンス名]_Multicam"** が作成されます

**処理時間の目安**:
- 30分の映像 → 約1-2分
- 60分の映像 → 約2-4分

**注意**:
- 処理中はPremiere Proの他の操作を控えてください
- 長時間の映像（60分以上）の場合、最初に短い区間でテストすることをお勧めします

### Step 4: 調整 (Refinement)

生成されたシーケンスを確認し、必要に応じて手動調整します。

#### 視覚化グラフの見方

処理完了後、パネルに**音声レベルグラフ**が表示されます:

```
Camera 1: ████████░░░░░░░░████████
Camera 2: ░░░░░░░░████████░░░░░░░░
Camera 3: ░░░░░░░░░░░░░░░░░░░░░░░░
Active:   [1][1][1][2][2][2][1][1]
```

- **バーの高さ** = 各カメラの音声レベル
- **Active行** = 実際に選択されたカメラ
- **時間軸** = 横方向にスクロール可能

#### 手動調整のポイント

生成されたシーケンスは**ベースライン**です。以下のような場合は手動で微調整してください:

1. **カット点の調整**
   - 話し始めのタイミングがずれている → カット点を前後に移動
   - カット点の移動: タイムライン上で直接ドラッグ

2. **カメラ選択の変更**
   - 引きの画（Camera 3）を増やしたい → 手動で該当区間のクリップを置換
   - 特定の発言で特定カメラを使いたい → クリップを手動で入れ替え

3. **不要なカットの削除**
   - 短すぎるカット、不自然な切り替え → クリップを結合または削除

4. **トランジションの追加**
   - 設定で0秒にした場合でも、後から手動でクロスディゾルブを追加可能

---

## 詳細設定

### 高度な設定オプション

#### 1. サンプリングレートの調整

**推奨値**: 1.0秒（バランス重視）

- **0.5秒以下**: 非常に精密だが処理時間が増加、60分の映像で4-6分
- **1.0秒**: デフォルト、ほとんどのケースで十分な精度
- **2.0秒以上**: 高速処理だが会話の切り替わりを見逃す可能性

**使い分け**:
```
高速な会話、複数人が重なる → 0.5-1.0秒
通常の対談・インタビュー → 1.0秒（推奨）
ゆっくりした講演、1人の長い発言 → 1.5-2.0秒
```

#### 2. 最小カット長の調整

**推奨値**: 2.0秒

- **1.0秒以下**: 非常に細かいカット、編集が忙しくなる
- **2.0秒**: デフォルト、視聴者が快適に見られる長さ
- **3.0秒以上**: ゆったりとした編集、カット数が減る

**ルール**: 最小カット長 × カット頻度 = 実際のカット間隔

#### 3. カット頻度とスレッショルド

内部的には、各周波数設定で異なる**スレッショルド**が適用されます:

| カット頻度 | スレッショルド | 実際のカット間隔（最小2秒の場合） |
|-----------|--------------|---------------------------|
| **High** | 0.6 | 1-2秒（頻繁に切り替わる） |
| **Medium** | 0.7 | 2-3秒（バランス） |
| **Low** | 0.8 | 3-5秒（ゆったり） |

**スレッショルド**: 音声レベルがこの値を超えると「話している」と判定

---

## 結果の確認と調整

### 生成されたシーケンスの構造

処理完了後、以下の構造のシーケンスが作成されます:

```
[元のシーケンス名]_Multicam
├── Video Track 1: 自動編集されたマルチカメラカット
│   ├── Clip from Camera 1 (0:00-0:05)
│   ├── Clip from Camera 2 (0:05-0:12)
│   ├── Clip from Camera 3 (0:12-0:15)
│   └── ... (以下続く)
└── Audio Tracks: 元の音声トラック（同期済み）
```

### 品質チェックリスト

生成されたシーケンスを以下の観点で確認してください:

- [ ] **カット点の正確性** - 話し始め/終わりのタイミングは適切か？
- [ ] **カメラ選択の妥当性** - 話者に対応するカメラが選ばれているか？
- [ ] **カット頻度** - 切り替わりが多すぎる/少なすぎないか？
- [ ] **不自然なカット** - 話の途中で不自然に切り替わっていないか？
- [ ] **音声の連続性** - 音声トラックが途切れていないか？

### 典型的な調整パターン

#### パターン1: 引きの画を増やす

**問題**: Camera 1とCamera 2（話者のアップ）ばかりで、Camera 3（引き）が少ない

**解決策**:
1. タイムライン上で、会話の区切りや間を探す
2. 該当区間のクリップをCamera 3に手動で置換
3. 推奨タイミング: 話題転換時、笑い声の後、間が空いたとき

#### パターン2: 特定カメラを優先したい

**問題**: 話者Aの発言は常にCamera 1で撮りたい

**解決策**:
1. 音声レベルグラフで話者Aの区間を特定（Camera 1のバーが高い区間）
2. 該当区間のクリップがCamera 1になっているか確認
3. 違うカメラになっている場合は手動で置換

#### パターン3: カットが多すぎる

**問題**: 1-2秒ごとに切り替わってせわしない

**解決策**:
1. **設定を変更して再処理**:
   - 最小カット長: 2.0秒 → 3.0秒
   - カット頻度: Medium → Low
2. または**手動で短いクリップを結合**:
   - 連続する同じカメラのクリップを選択 → 右クリック → "リンク解除" → クリップを結合

---

## トラブルシューティング

### 処理が失敗する

#### エラー: "カメラが3つ選択されていません"

**原因**: Step 1でカメラ設定が不完全

**解決策**:
- Camera 1, 2, 3すべてにクリップが割り当てられているか確認
- パネル上で "Camera 1: [クリップ名]" のように表示されているか確認

#### エラー: "音声トラックが見つかりません"

**原因**: 選択したクリップに音声トラックが含まれていない

**解決策**:
1. タイムライン上で各カメラクリップを選択
2. "エフェクトコントロール" パネルで音声トラックの有無を確認
3. 音声がない場合は、元の素材から音声付きクリップに差し替える

#### エラー: "処理中にエラーが発生しました"

**原因**: メモリ不足、またはクリップの破損

**解決策**:
1. Premiere Proを再起動してメモリをクリア
2. より短い区間（10-20分）でテスト
3. サンプリングレートを2.0秒に上げて処理負荷を軽減

### 結果が期待と違う

#### 問題: 話していない人のカメラが選ばれる

**原因**: 音声レベルが低い、またはマイク設定の問題

**診断**:
1. 音声レベルグラフを確認
2. 該当区間で各カメラの音声バーの高さを比較
3. 話している人のバーが一番高くなっているか？

**解決策**:
- 音声レベルが低い場合: Premiere Pro上で各クリップの音声レベルを調整してから再処理
- マイク設定の問題: 各カメラで正しいマイクの音声が収録されているか確認

#### 問題: カットが少なすぎる

**原因**: カット頻度が Low、または最小カット長が長すぎる

**解決策**:
1. カット頻度: Low → Medium または High
2. 最小カット長: 3.0秒 → 2.0秒または1.5秒
3. サンプリングレート: 2.0秒 → 1.0秒（精度を上げる）

#### 問題: カットが多すぎる

**原因**: カット頻度が High、または最小カット長が短すぎる

**解決策**:
1. カット頻度: High → Medium または Low
2. 最小カット長: 1.5秒 → 2.0秒または3.0秒
3. サンプリングレート: 0.5秒 → 1.0秒（処理を粗くする）

### パフォーマンスの問題

#### 問題: 処理に時間がかかりすぎる

**原因**: 映像が長い、またはサンプリングレートが細かすぎる

**解決策**:
1. **テスト区間を使う**: 最初の10分だけ処理してパラメータを調整
2. **サンプリングレートを上げる**: 1.0秒 → 1.5秒または2.0秒
3. **セグメント処理**: 60分の映像を30分×2に分けて処理

**推奨アプローチ**:
```
1. 最初の5分で High/Medium/Low を試す（各1-2分）
2. 最適な設定を見つけたら全体を処理（30-60分の場合）
3. または10分単位でセグメント処理して結合
```

---

## FAQ

### Q1: Autopodとの違いは？

**A**: 基本的なワークフローと機能は同じですが、以下の点が異なります:

| 項目 | Multi-Camera Editor | Autopod |
|-----|---------------------|---------|
| **API** | UXP (Premiere Pro v25.0+) | ExtendScript (幅広いバージョン対応) |
| **話者検出** | 音声レベルベース（シンプル） | 高度なアルゴリズム（より精密） |
| **カスタマイズ** | サンプリングレート、カット頻度調整可能 | プリセット中心 |
| **追加機能** | Multi-Camera Editorのみ | Social Clip Creator、Jump Cut Editorも含む |

詳細は [`AUTOPOD_COMPARISON.md`](./AUTOPOD_COMPARISON.md) を参照してください。

### Q2: 4カメラ以上に対応していますか？

**A**: 現バージョンは3カメラ専用です。4カメラ以上のサポートは将来のバージョンで検討中です。

**回避策**:
- 4カメラの場合: 最も使用頻度の低いカメラを除外して3カメラで処理
- 処理後、手動で4つ目のカメラのクリップを追加

### Q3: トランジションをデフォルトで追加できますか？

**A**: はい、Step 2の設定で「トランジション」を0.0秒以外に設定してください。

例:
- トランジション: 0.5秒 → 各カット間に0.5秒のクロスディゾルブが自動追加
- 推奨: 0.0-0.3秒（長すぎると不自然）

### Q4: 音声が重なる区間はどう処理されますか？

**A**: 最も音声レベルが高いカメラが選ばれます。

例:
- Camera 1: 0.8（話者A、大きい声）
- Camera 2: 0.5（話者B、小さい声）
- → Camera 1が選択される

完全に同レベルの場合は、Camera番号が若い方が優先されます。

### Q5: 生成されたシーケンスを元に戻せますか？

**A**: 元のシーケンスは変更されません。生成されたシーケンス（"[元の名前]_Multicam"）を削除すれば、いつでも最初からやり直せます。

**ベストプラクティス**:
1. 元のシーケンスは保持
2. 設定を変えて複数バージョン生成（例: "Interview_Multicam_High", "Interview_Multicam_Low"）
3. 最適なものを選んで微調整

### Q6: 一部の区間だけ処理できますか？

**A**: 現バージョンはシーケンス全体を処理します。

**回避策**:
1. タイムライン上で処理したい区間のみを含む新しいシーケンスを作成
2. その新しいシーケンスで Multi-Camera Editor を実行
3. 処理後、元のシーケンスに結果をコピー＆ペースト

### Q7: エクスポート後に再編集できますか？

**A**: はい。生成されたシーケンスは通常のPremiere Proシーケンスです。

可能な操作:
- カット点の調整、クリップの置換
- カラーグレーディング、エフェクト追加
- トランジション、タイトルの追加
- 音声のミキシング

---

## 推奨ワークフロー（実践例）

### シナリオ: 60分の対談ポッドキャスト編集

**前提**:
- 話者A、話者B の2人
- Camera 1: 話者Aのアップ
- Camera 2: 話者Bのアップ
- Camera 3: 2人の引きの画

**ステップ**:

1. **準備** (5分)
   - 3カメラの映像をタイムラインに配置
   - 音声を同期（マルチカメラツールまたは手動）
   - 全体を通して再生し、音声レベルを確認

2. **テスト処理** (10分)
   - 最初の5分の区間で新しいシーケンスを作成
   - Multi-Camera Editorで処理:
     - 最小カット長: 2.0秒
     - サンプリングレート: 1.0秒
     - カット頻度: Medium
   - 結果を確認し、必要なら High または Low で再処理

3. **全体処理** (2-4分)
   - 最適な設定で60分全体を処理
   - 完了を待つ（コーヒーブレイク☕）

4. **確認と調整** (30-60分)
   - 生成されたシーケンスを再生
   - 不自然なカット点を手動で調整
   - 引きの画（Camera 3）を追加したい箇所を特定して置換
   - トランジションやタイトルを追加

5. **仕上げ** (30分)
   - カラーグレーディング
   - 音声ミキシング
   - タイトル、テロップ追加

**合計編集時間**: 約2-3時間（従来の手動編集: 6-8時間）

---

## まとめ

Multi-Camera Editorは、Autopodのシンプルなワークフローを踏襲しながら、Premiere Pro UXPの最新技術で実装された自動マルチカメラ編集ツールです。

**4つのステップを覚えましょう**:
1. **セットアップ** - 3つのカメラを選択
2. **設定** - カット頻度、最小カット長などを調整
3. **処理** - "Create Multicam Edit"で自動編集
4. **調整** - 生成されたシーケンスを確認、微調整

**初めての方へ**:
- 最初は短い区間（5-10分）でテスト
- デフォルト設定から始める
- 音声レベルグラフを活用して結果を理解する
- 手動調整を恐れない（自動編集は70-80%の完成度を目指すツールです）

さらに詳しい情報は以下のドキュメントを参照してください:
- [ARCHITECTURE.md](./ARCHITECTURE.md) - システム設計の詳細
- [API.md](./API.md) - モジュールAPIリファレンス
- [AUTOPOD_COMPARISON.md](./AUTOPOD_COMPARISON.md) - Autopodとの比較

**Happy Editing!** 🎬
